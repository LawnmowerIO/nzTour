!function(){var t=angular.module("nzTour",[]);t.factory("nzTour",["$q","$rootScope","$compile","$timeout",function(t,e,r,n){function o(t){if(!t)throw"No Tour Specified!";if(!t.steps.length)throw"No steps were found in that tour!";return z.current?i().then(function(){return f(t)}):f(t)}function i(){return p(!1).then(b)}function u(){z.current&&T()}function s(){return z.current||z.current.reject(),g().then(v).then(m).then(d)}function c(){var e=t.defer();return z.current.step>0?(z.current.step--,d()):(e.reject(),e.promise)}function a(e){var r=t.defer();return e>0&&e<=z.current.tour.steps.length?(z.current.step=e-2,d(!0)):(r.reject(),r.promise)}function f(e){return e.config=angular.extendDeep({},z.config,e.config),console.log(e),z.current={tour:e,step:0,promise:t.defer()},p(!0,e),d(),z.current.promise.promise}function p(e,o){var i=t.defer();return e?(z.box=angular.element(r('<nz-tour class="hidden"></nz-tour>')(z)),angular.element(o.config.container).append(z.box),n(function(){z.box.removeClass("hidden")},10),i.resolve()):(z.box.addClass("hidden"),n(function(){z.box.remove(),z.$broadcast("remove"),i.resolve()},z.current.tour.config.animationDuration)),i.promise}function d(){return l().then(h)}function l(){var e=t.defer();return z.current.tour.steps[z.current.step].before?z.current.tour.steps[z.current.step].before():(e.resolve(),e.promise)}function h(){var e=t.defer();return z.$broadcast("step",z.current.step),e.resolve(),e.promise}function g(){var e=t.defer();return z.current.tour.steps[z.current.step].after?z.current.tour.steps[z.current.step].after():(e.resolve(),e.promise)}function v(){var e=t.defer();return z.current.step==z.current.tour.steps.length-1&&(x(),e.reject()),e.resolve(),e.promise}function m(){var e=t.defer();return z.current.step++,e.resolve(),e.promise}function x(){p(!1).then(function(){return z.current.promise.resolve(),z.current=!1,!0})}function b(){return z.current.promise.reject(),z.current=!1,!0}function T(){}function w(t,e,r){var o;return function(){var i=this,u=arguments,s=function(){o=null,r||t.apply(i,u)},c=r&&!o;n.cancel(o),o=n(s,e),c&&t.apply(i,u)}}var z=e.$new();return angular.extend(z,{config:{mask:{visible:!0,clickThrough:!1,clickExit:!1,color:"rgba(0,0,0,.7)"},dark:!1,container:"body",scrollBox:"body",previousText:"Previous",nextText:"Next",finishText:"Finish",animationDuration:400},current:!1,container:!1,box:!1,start:o,stop:i,pause:u,next:s,previous:c,gotoStep:a,debounce:w}),window.nzTour=z,z}]),t.directive("nzTour",["$q","$timeout","$window",function(t,e,r){return{template:['<div id="nzTour-box-wrap">','   <div id="nzTour-box">','        <div id="nzTour-tip" class="top center"></div>','        <div id="nzTour-step">{{view.step + 1}}</div>','        <div id="nzTour-length">{{view.length}}</div>','        <div id="nzTour-close" ng-click="stop()">&#10005</div>','        <div id="nzTour-content">','           <div id="nzTour-inner-content">{{view.content}}</div>',"        </div>",'        <div id="nzTour-actions">','            <button id="nzTour-previous" ng-show="view.step > 0" ng-click="previous()" class="ng-hide">{{view.previousText}}</button>','            <button id="nzTour-next" ng-show="view.step >= 0" ng-click="next()" class="success" class="ng-hide">{{view.nextText}}</button>',"        </div>","    </div>","</div>",'<div class="nzTour-masks" ng-show="current.tour.config.mask.visible" ng-click="tryStop()">','    <div class="mask top"></div>','    <div class="mask right"></div>','    <div class="mask bottom"></div>','    <div class="mask left"></div>',"</div>"].join(" "),link:function(n,o){function i(){x||n.view&&u(null,n.view.step)}function u(t,e){return n.view={step:e,length:n.current.tour.steps.length,content:n.current.tour.steps[e].content,previousText:n.current.tour.config.previousText,nextText:e==n.current.tour.steps.length-1?n.current.tour.config.finishText:n.current.tour.config.nextText},s(n.current.tour.steps[e].target).then(c).then(a)}function s(e){var r=t.defer(),n=angular.element(e);return r.resolve(n.length?angular.element(n[0]):!1),r.promise}function c(e){function r(t){var e=l.height(),r=l.scrollTop(),n=r+e,o=t.offset().top-l.offset().top+r,i=o+t.height();return t.height()>e?i>=n||r>=o:n>=i&&o>=r}function o(e){var r=t.defer();return x=!0,angular.element(l).animate({scrollTop:e.offset().top-l.offset().top+l.scrollTop()-b},n.current.tour.config.animationDuration,function(){r.resolve(e),x=!1}),r.promise}var i=t.defer();return e?r(e)?(i.resolve(e),i.resolve(e),i.promise):o(e):(i.resolve(),i.promise)}function a(r){var o=t.defer();if(!r)return p(),void d();var i=f(r);return p(i),d(i),e(function(){o.resolve()},n.current.tour.config.animationDuration),o.promise}function f(t){var e=angular.element(n.current.tour.config.container),r={pos:t.offset(),width:t.outerWidth(),height:t.outerHeight()},o={pos:e.offset(),width:e.width(),height:e.height()};return{width:r.width,height:r.height,top:r.pos.top-o.pos.top,left:r.pos.left-o.pos.left,bottom:o.height-r.pos.top-r.height,right:o.width-r.pos.left-r.width}}function p(t){function e(e,r){var n,o,i,u,s;"top"==e?(n=t.top-b,s="bottom",u="-100%"):(n=t.top+t.height+b,s="top",u="0"),"right"==r?(o=t.left+t.width,i="-100%"):"center"==r?(o=t.left+t.width/2,i="-50%"):(o=t.left,i="0"),g.css({left:o+"px",top:n+"px",transform:"translate("+i+","+u+")"}),m.attr("class",s+" "+r)}function r(e,r){var n,o,i,u,s;"right"==e?(o=t.left+t.width+b,s="left",i="0"):(o=t.left-b,s="right",i="-100%"),"top"==r?(n=t.top,u="0"):"center"==r?(n=t.top+t.height/2,u="-50%"):(n=t.top+t.height,u="-100%"),g.css({left:o+"px",top:n+"px",transform:"translate("+i+","+u+")"}),m.attr("class","side "+s+" "+r)}function n(e,r){var n,o,i,u;"top"==e?(n=t.top+b,i="0"):(n=t.top+t.height-b-(t.bottom<0?-t.bottom:0),i="-100%"),"right"==r?(o=t.left+t.width-b,u="-100%"):"center"==r?(o=t.left+t.width/2,u="-50%"):(o=t.left+b,u="0"),g.css({left:o+"px",top:n+"px",transform:"translate("+u+","+i+")"}),m.attr("class","hidden")}function o(){g.css({left:"50%",top:"50%",transform:"translate(-50%, -50%)",margin:"0"}),m.attr("class","hidden")}return t?t.bottom>135?t.width>250?void e("bottom","center"):t.right+t.width>250?void e("bottom","left"):void e("bottom","right"):t.right>250?t.height>135?void r("right","center"):t.bottom+t.height>135?void r("right","top"):void r("right","bottom"):t.left>250?t.height>135?void r("left","center"):t.bottom+t.height>135?void r("left","top"):void r("left","bottom"):t.top>135?t.width>250?void e("top","center"):t.right+t.width>250?void e("top","left"):void e("top","right"):void n("bottom","center"):void o()}function d(t){return t?(h.top.css({height:t.top+"px"}),h.bottom.css({height:t.bottom+"px"}),h.left.css({top:t.top+"px",height:t.height+"px",width:t.left+"px"}),void h.right.css({top:t.top+"px",height:t.height+"px",width:t.right+"px"})):(h.top.css({height:"0px"}),h.bottom.css({height:"0px"}),h.left.css({top:"0px",height:"100%",width:"0px"}),void h.right.css({top:"0px",height:"100%",width:"0px"}))}var l=(angular.element(n.current.tour.config.container),angular.element(n.current.tour.config.scrollBox)),h={all:o.find(".nzTour-masks"),top:o.find(".nzTour-masks .top"),right:o.find(".nzTour-masks .right"),bottom:o.find(".nzTour-masks .bottom"),left:o.find(".nzTour-masks .left")},g=o.find("#nzTour-box-wrap"),v=o.find("#nzTour-box"),m=o.find("#nzTour-tip"),x=(o.find("#nzTour-step"),o.find("#nzTour-close"),o.find("#nzTour-content"),o.find("#nzTour-actions"),o.find("#nzTour-previous"),o.find("#nzTour-next"),!1),b=15;h.all.css("pointer-events",n.current.tour.config.mask.clickThrough?"none":"all"),n.current.tour.config.dark&&(v.addClass("dark-box"),b=7),g.add(v).add(m).css("transition","all "+n.current.tour.config.animationDuration+"ms ease"),h.top.add(h.right).add(h.bottom).add(h.left).css({transition:"all "+n.current.tour.config.animationDuration+"ms ease","background-color":n.current.tour.config.mask.color}),n.$on("step",u);var T=n.debounce(i,100);n.$on("remove",function(){angular.element(r).off("resize",T),l.off("scroll",T)}),angular.element(r).on("resize",T),l.on("scroll",T),n.tryStop=function(){n.current.tour.config.mask.clickExit&&n.stop()}}}}]),window.angular.extendDeep=function e(t){return angular.forEach(arguments,function(r){r!==t&&angular.forEach(r,function(r,n){t[n]&&t[n].constructor&&t[n].constructor===Object?e(t[n],r):t[n]=r})}),t}}();